<!--
  ~ Copyright Â© 2017-2021 CESSDA ERIC (support@cessda.eu)
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License").
  ~ You may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~  http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and limitations under the License.
  -->

<form name="deprecateCodeForm" role="form" (ngSubmit)="save(conceptParam.id!)" novalidate [formGroup]="deprecateCodeForm">
    <div class="modal-header">
        <h4 class="modal-title">
            <span>Deprecation of the code <strong>{{conceptParam.notation}}</strong></span>
        </h4>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                (click)="clear()">&times;</button>
    </div>
    <div class="modal-body">
        <jhi-alert-error></jhi-alert-error>
        <div *ngIf="isConfirmedDeprecation; else toConfirmDeprecationBody">
            <div *ngIf="isConfirmedReplacement; else toConfirmReplacementBody" class="form-group">
                <div class="row-content">
                    <div class="row-details">
                        <div class="row-detail form-group">
                            <div class="label-column-input">
                                <span ngbTooltip="Choose a code, which replaces the code being deprecated" [ngClass]="{'label-required':true}">Replacing code</span>
                            </div>
                            <div class="detail-column">
                                <select class="form-control w-auto sk-select" id="replacingCode" name="replacingCode" formControlName="replacingCode">
                                    <ng-container *ngFor="let concept of conceptList">
                                        <option *ngIf="!concept.deprecated && concept.id !== conceptParam.id" [value]="concept.id">{{concept.notation}}</option>
                                    </ng-container>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <ng-template #toConfirmReplacementBody>
                <div>
                    <p>Is the deprecated code <strong>{{conceptParam.notation}}</strong> replaced by some other code in the vocabulary?</p>
                </div>
            </ng-template>
        </div>
        <ng-template #toConfirmDeprecationBody>
            <div>
                <p>Are you sure you want to deprecate code <strong>{{conceptParam.notation}}</strong>? Any children codes under <strong>{{conceptParam.notation}}</strong> will also be deprecated!</p>
                <p>If there are children codes and you want to keep them, move them first not to be children to <strong>{{conceptParam.notation}}</strong>.</p>
            </div>
        </ng-template>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="clear()">
            <fa-icon [icon]="'ban'"></fa-icon>&nbsp;<span jhiTranslate="entity.action.cancel">Cancel</span>
        </button>
        <div *ngIf="isConfirmedDeprecation; else toConfirmDeprecationFooter">
            <div *ngIf="isConfirmedReplacement; else toConfirmReplacementFooter">
                <button id="jhi-confirm-deprecate-vocabulary" type="submit" class="btn btn-warning">
                    <fa-icon [icon]="'wind'"></fa-icon>&nbsp;<span jhiTranslate="entity.action.deprecate">Deprecate</span>
                </button>
            </div>
            <ng-template #toConfirmReplacementFooter>
                <div>
                    <button id="jhi-confirm-replace-concept" class="btn btn-warning" (click)="confirmReplacement()">
                        <fa-icon></fa-icon>&nbsp;<span jhiTranslate="entity.action.yes">Yes</span>
                    </button>
                </div>
            </ng-template>
        </div>
        <ng-template #toConfirmDeprecationFooter>
            <button id="jhi-confirm-deprecate-concept" class="btn btn-warning" (click)="confirmDeprecation()">
                <fa-icon></fa-icon>&nbsp;<span jhiTranslate="entity.action.yes">Yes</span>
            </button>
        </ng-template>
    </div>
</form>
